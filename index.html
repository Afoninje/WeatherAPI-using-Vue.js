<!DOCTYPE html>

<link
  rel="stylesheet"
  href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css"
  integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO"
  crossorigin="anonymous"
/>
<style>
  [v-cloak] {
    display: none;
  }
</style>
<div class="container">
  <form class="mt-5">
    <button class="btn btn-primary">
      <a href="top5.html" style="color: white;">
        Click here to view the temperature of 5 Major cities
      </a>
    </button>
  </form>
</div>

<div id="app">
  <div class="container">
    <form class="mt-5">
      <div class="form-group">
        <label for="email">Search for City</label>
        <input
          type="text"
          v-model="city"
          id="citysearch"
          class="form-control form-control-lg"
        />
      </div>
      <button type="submit" @click.prevent="process" class="btn btn-primary">
        Submit
      </button>
    </form>

    <div id="app" v-show="submitted" v-cloak>
      <div class="container">
        <div class="card mt-5">
          <h2 class="card-header">Weather Chart</h2>
          <table class="table">
            <thead class="thead-dark">
              <th></th>
              <th>Name of the City:</th>
              <th>Time Of Last Observation (GMT):</th>
              <th>Current Temperature Of The City:</th>
              <th>Current Date & Local Time:</th>
              <th>Humidity:</th>
            </thead>
            <tbody>
              <tr>
                <td><img :src="icon" /></td>
                <td>{{city}}</td>
                <td>{{observation_time}}</td>
                <td>{{temperature}}Â°C</td>
                <td>{{localtime}}</td>
                <td>{{humidity}}%</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/vue@2.5.17/dist/vue.js"></script>
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>

    <script>
      var apiKey = "d96d6ea71d0d515f00a47cb5b4e4b67";
      var url =
        "http://api.weatherstack.com/current?access_key=" + apiKey + "f&query=";

      var vm = new Vue({
        el: "#app",
        data: {
          city: "",
          submitted: false,
          observation_time: "",
          temperature: "",
          localtime: "",
          icon: "",
          humidity: "",
        },

        methods: {
          process: function () {
            this.submitted = true;
            url = url + vm.city;

            axios.get(url).then(function (res) {
              console.clear();
              console.log(res);

              vm.city = res.data.location.name;
              vm.observation_time = res.data.current.observation_time;
              vm.temperature = res.data.current.temperature;
              vm.localtime = res.data.location.localtime;
              vm.icon = res.data.current.weather_icons;
              vm.humidity = res.data.current.humidity;
            });
          },
        },
      });
    </script>
  </div>
</div>
