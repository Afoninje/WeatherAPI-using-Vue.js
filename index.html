<!DOCTYPE html>
<html>
  <head>
    <link
      href="https://fonts.googleapis.com/css?family=Roboto:100,300,400,500,700,900"
      rel="stylesheet"
    />
    <link
      href="https://cdn.jsdelivr.net/npm/@mdi/font@4.x/css/materialdesignicons.min.css"
      rel="stylesheet"
    />
    <link
      href="https://cdn.jsdelivr.net/npm/vuetify@2.x/dist/vuetify.min.css"
      rel="stylesheet"
    />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/vue/2.5.13/vue.js"></script>
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, minimal-ui"
    />
  </head>

  <link
    rel="stylesheet"
    href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css"
    integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO"
    crossorigin="anonymous"
  />

  <style>
    [v-cloak] {
      display: none;
    }
  

  </style>

  <body>
    
    </div>
    <div id="app">
      <div class="container">
      <form class="mt-5">
        <div class="form-group">
          <h1>If using this on a mobile phone , please turn on location in the settings</h1>
          <button
            type="submit"
            @click.prevent="myFunction()"
            class="btn btn-primary"
          >
            Click Here To Get Information About Your Current Location
          </button>
        </div>
      </div>
      </form>
      <div id="app" v-cloak v-show="usersubmitted">
        <div class="container">
          <div class="card mt-5">
            <h2 class="card-header">Your Current Location</h2>
            <table class="table">
              <thead class="thead-dark">
                <th></th>
                <th>Current Temperature:</th>
                <th>Description:</th>
                <th>Current Pressure:</th>
                <th>Current Humidity:</th>
              </thead>
              <tbody>
                <tr>
                  <td><img :src="usermaindesc"/></td>
                  <td>{{usertemp}}°C</td>
                  <td>{{userdesc}}</td>
                  <td>{{userpressure}} Pa</td>
                  <td>{{userhumidity}}%</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>

      <div class="container">
        <form class="mt-5">
          <div class="form-group">
            <label>Search for City</label>
            <input
              type="text"
              v-model="citycopy"
              id="citysearch"
              class="form-control form-control-lg"
            />
          </div>

          <button
            type="submit"
            @click.prevent="process"
            class="btn btn-primary"
          >
            Submit
          </button>
        </form>

        <div id="app" v-show="submitted" v-cloak>
          <div class="container" background>
            <div class="card mt-5">
              <h2 class="card-header">Information for: {{city}}</h2>
              <table class="table">
                <thead class="thead-dark">
                <th></th>
                <th>Current Temperature:</th>
                <th>Description:</th>
                <th>Current Pressure:</th>
                <th>Current Humidity:</th>
              </thead>
              <tbody>
                <tr>
                  <td><img :src="findmaindesc"/></td>
                  <td>{{findtemp}}°C</td>
                  <td>{{finddesc}}</td>
                  <td>{{findpressure}} Pa</td>
                  <td>{{findhumidity}}%</td>
                </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
      </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/vuetify@2.x/dist/vuetify.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/vue@2.x/dist/vue.js"></script>
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>

    <script>
      var url =
        "https://api.openweathermap.org/data/2.5/weather?q=&appid=ad59e4fb24b7f88d5eaf006cc977159e";
      var urlcopy =
      "https://api.openweathermap.org/data/2.5/weather?q=&appid=ad59e4fb24b7f88d5eaf006cc977159e";

      var vm = new Vue({
        el: "#app",
        vuetify: new Vuetify(),
        data: {
          city: "",
          citycopy: "",
          submitted: false,
          usersubmitted: false,
          observation_time: "",
          findtemp: "",
          finddesc: "",
          findhumidity: "",
          findpressure: "",
          error: "",
          lat: "",
          lon: "",
          userdesc: "",
          usertemp: "",
          userpressure: "",
          userhumidity: "",
          findIconCode: "",
          userIconCode: "",
          displayImageURL: "",
          usermaindesc: "",
          findmaindesc: "",
        },

        methods: {
          process: function () {
            this.submitted = true;

            vm.city = vm.citycopy;

            var url =
            "https://api.openweathermap.org/data/2.5/weather?q="+vm.city+"&appid=ad59e4fb24b7f88d5eaf006cc977159e";
        

            axios.get(url).then(function (res) {
              console.clear();
              console.log(res);

              vm.finddesc = res.data.weather[0].description;
              vm.findhumidity = res.data.main.humidity;
              vm.findpressure = res.data.main.pressure;
              vm.findtemp = res.data.main.temp;
              vm.findtemp = vm.findtemp - 273.15;
              vm.findtemp = vm.findtemp.toFixed(2);
              vm.findIconCode = res.data.weather[0].icon;
              vm.findmaindesc = res.data.weather[0].main;


                if(vm.findIconCode == "01d")
                {
                  vm.findmaindesc="WeatherPhotos/sunny.gif";
                }
                else if(vm.findIconCode == "01n")
                {
                  vm.findmaindesc="WeatherPhotos/night.gif";
                }
                else if(vm.findmaindesc == "Clouds")
                {
                  vm.findmaindesc="WeatherPhotos/partlycloud.gif";
                }
                else if(vm.findmaindesc == "Snow")
                {
                  vm.findmaindesc="WeatherPhotos/snow.gif";
                }
                else if(vm.findmaindesc == "Rain")
                {
                  vm.findmaindesc="WeatherPhotos/rain.gif";
                }
                else if(vm.findmaindesc == "Drizzle")
                {
                  vm.findmaindesc="WeatherPhotos/rain.gif";
                }
                else if(vm.findmaindesc == "Thunderstorm")
                {
                  vm.findmaindesc="WeatherPhotos/thunder.gif";
                }
                else if(vm.findmaindesc == "Dust")
                {
                  vm.findmaindesc="WeatherPhotos/Wind.gif";
                }
                else if(vm.findmaindesc == "Tornado")
                {
                  vm.findmaindesc="WeatherPhotos/Wind.gif";
                }
                else
                {
                  vm.findmaindesc="WeatherPhotos/Mist.gif";
                }

              url = urlcopy;
            });
          },

          myFunction: function () {
            if (navigator.geolocation) {
              navigator.geolocation.getCurrentPosition(this.showPosition);
            } else {
              this.error = "Geolocation is not supported.";
            }
          },
          showPosition: function (position) {
            this.lat = position.coords.latitude;
            this.lon = position.coords.longitude;

            axios
              .get(
                "https://api.openweathermap.org/data/2.5/weather?lat=" +
                  this.lat +
                  "&lon=" +
                  this.lon +
                  "&appid=ad59e4fb24b7f88d5eaf006cc977159e"
              )
              .then(function (res2) {
                console.clear();
                console.log(res2);

                vm.userdesc = res2.data.weather[0].description;
                vm.userhumidity = res2.data.main.humidity;
                vm.userpressure = res2.data.main.pressure;
                vm.usertemp = res2.data.main.temp;
                vm.usertemp = vm.usertemp - 273.15;
                vm.usertemp = vm.usertemp.toFixed(2);
                vm.userIconCode = res2.data.weather[0].icon;
                vm.usermaindesc = res2.data.weather[0].main;

                if(vm.userIconCode == "01d")
                {
                  vm.usermaindesc="WeatherPhotos/sunny.gif";
                }
                else if(vm.userIconCode == "01n")
                {
                  vm.usermaindesc="WeatherPhotos/night.gif";
                }
                else if(vm.usermaindesc == "Clouds")
                {
                  vm.usermaindesc="WeatherPhotos/partlycloud.gif";
                }
                else if(vm.usermaindesc == "Snow")
                {
                  vm.usermaindesc="WeatherPhotos/snow.gif";
                }
                else if(vm.usermaindesc == "Rain")
                {
                  vm.usermaindesc="WeatherPhotos/rain.gif";
                }
                else if(vm.usermaindesc == "Drizzle")
                {
                  vm.usermaindesc="WeatherPhotos/rain.gif";
                }
                else if(vm.usermaindesc == "Thunderstorm")
                {
                  vm.usermaindesc="WeatherPhotos/thunder.gif";
                }
                else if(vm.usermaindesc == "Dust")
                {
                  vm.usermaindesc="WeatherPhotos/Wind.gif";
                }
                else if(vm.usermaindesc == "Tornado")
                {
                  vm.usermaindesc="WeatherPhotos/Wind.gif";
                }
                else
                {
                  vm.usermaindesc="WeatherPhotos/Mist.gif";
                }


              });
            this.usersubmitted = true;
          },
        },
      });
    </script>
  </body>
</html>
